<?php
/** @noinspection PhpArrayWriteIsNotUsedInspection */

declare(strict_types=1);

namespace Tests\Feature\Models;

use App\Models\Country;
use App\Models\Customer;
use App\Models\Payment;
use Illuminate\Support\Facades\Log;
use Tests\TestCase;

class CustomerTest extends TestCase
{
    public function testThereAre599Customers(): void
    {
        $customerCount = Customer::count();

        $this->assertSame(599, $customerCount);
    }

    public function testTheFirstCustomerIsMarySmith(): void
    {
        $firstCustomer = Customer::first();

        $customer = [
            'id'         => 1,
            'store_id'   => 1,
            'first_name' => 'MARY',
            'last_name'  => 'SMITH',
            'email'      => 'MARY.SMITH@sakilacustomer.org',
            'address_id' => 5,
            'active'     => 1,
            'created_at' => '2006-02-14 22:04:36',
            'updated_at' => '2006-02-15 04:57:20',
        ];

        $this->assertSame($customer['first_name'], $firstCustomer->first_name);
        $this->assertSame($customer['last_name'], $firstCustomer->last_name);
        $this->assertSame($customer['email'], $firstCustomer->email);
    }

    /** @noinspection SpellCheckingInspection */
    public function testTheLastCustomerStaffIsAustinCintron(): void
    {
        $customer599 = Customer::find(599);

        $customer = [
            'id'         => 599,
            'store_id'   => 2,
            'first_name' => 'AUSTIN',
            'last_name'  => 'CINTRON',
            'email'      => 'AUSTIN.CINTRON@sakilacustomer.org',
            'address_id' => 605,
            'active'     => 1,
            'created_at' => '2006-02-14 22:04:37',
            'updated_at' => '2006-02-15 04:57:20',
        ];

        $this->assertSame($customer['first_name'], $customer599->first_name);
        $this->assertSame($customer['last_name'], $customer599->last_name);
        $this->assertSame($customer['email'], $customer599->email);
    }

    public function testMarySmithAddressIs1913HanoiWay(): void
    {
        $firstCustomer = Customer::with('address')->first();

        $this->assertSame('1913 Hanoi Way', $firstCustomer->address->address);
    }

    /** @noinspection SpellCheckingInspection */
    public function testMarySmithStoreAddressIs47MySakilaDrive(): void
    {
        $firstCustomer = Customer::with('store')->with('store.address')->first();

        $this->assertSame(1, $firstCustomer->store->id);
        $this->assertSame('47 MySakila Drive', $firstCustomer->store->address->address);
    }

    public function testActiveCustomersCountStoreOne(): void
    {
        $activeCustomers = Customer::where('active', 1)->where('store_id', 1)->count();

        Log::info('testActiveCustomersCountByStore', [$activeCustomers]);

        $this->assertSame(318, $activeCustomers);
    }

    public function testCustomerOneFirstRentalIsFilmPatientSister(): void
    {
        $customerOne = Customer::with('rentals')->first();

        $this->assertSame(76, $customerOne->rentals->first()->id);
        $this->assertSame('PATIENT SISTER', $customerOne->rentals->first()->inventory->film->title);
    }

    public function testCustomerOneFirstPaymentIs299(): void
    {
        $customerOne = Customer::with('payments')->first();

        $this->assertSame(1, $customerOne->payments->first()->id);
        $this->assertSame('2.99', $customerOne->payments->first()->amount);
    }

    public function testAustralianCustomerTotalSpend(): void
    {
        // real world example, if we wanted to search for customers in Australia.
        $search = 'Australia';
        $country = Country::whereCountry($search)->first();

        // Note: this is the customers store address in Australia, not the customers address!
        // this gives us all the customers who have the Australian store and their spend
        $australianCustomers = Customer::with('payments')
            ->whereHas(
                'store.address.city.country',
                fn($query) => $query->where('country', $country->country)
            )
            ->whereHas(
                'payments',
                fn($query) => $query->where('amount', '>', 0)
            )
            ->get();
        // Maybe we would loop over all the customers and display their spend ðŸ¤·

        // Just an example on how to total the collection using PHP, see
        // WritingAComplexQueryOfJoiningResultsFromTwoSubQueriesTest for an example using withSum

        $totalSpend = $australianCustomers->sum(
            fn($customer) => $customer->payments->sum('amount')
        );

	// For some reason $titalSpend is 30414.990000000005. This kind of addrsses that.
        $this->assertSame(30414.99, round($totalSpend, 2));
    }

    public function testTheLastPaymentOffEveryCustomer(): void
    {
        $customer = Customer::addSelect([
            'last_payment' => Payment::select('amount')
                ->whereColumn('customer_id', 'customers.id')
                ->orderByDesc('payment_date')
                ->limit(1),
        ])->get();

        $this->assertSame(5.99, (float)$customer->first()->last_payment);

        /*
            0 => array:10 [
            "id" => 1
            "store_id" => 1
            "first_name" => "MARY"
            "last_name" => "SMITH"
            "email" => "MARY.SMITH@sakilacustomer.org"
            "address_id" => 5
            "active" => true
            "created_at" => "2006-02-14T22:04:36.000000Z"
            "updated_at" => "2006-02-15T04:57:20.000000Z"
            "last_payment" => "5.99"
            ]

        // etc....
        */
    }

    public function testTheLastTenPayingCustomers(): void
    {
        /** @var \Illuminate\Database\Eloquent\Collection<Customer> $lastTenPayingCustomer
         * @noinspection PhpFullyQualifiedNameUsageInspection
         */
        $lastTenPayingCustomer = Customer::select(['id', 'first_name', 'last_name'])
            ->orderByDesc(
                Payment::select('payment_date')
                    ->whereColumn('customer_id', 'customers.id')
                    ->orderByDesc('payment_date')
                    ->limit(1)
            )
            ->limit(10)
            ->get();

        $expected = [
            'id'         => 14,
            'first_name' => 'BETTY',
            'last_name'  => 'WHITE',
        ];

        $this->assertSame($expected, $lastTenPayingCustomer->first()->toArray());
    }

    public function testTheTopTenPayingCustomers(): void
    {
        /** @var \Illuminate\Database\Eloquent\Collection<Customer> $topTenPayingCustomers
         * @noinspection PhpFullyQualifiedNameUsageInspection
         */
        $topTenPayingCustomers = Customer::addSelect([
            'total_payments' => Payment::selectRaw('SUM(amount)')
                ->whereColumn('customer_id', 'customers.id'),
        ])
            ->orderByDesc('total_payments')
            ->limit(10)
            ->get();

        $expectedFirst = [
            "id"             => 526,
            "store_id"       => 2,
            "first_name"     => "KARL",
            "last_name"      => "SEAL",
            "email"          => "KARL.SEAL@sakilacustomer.org",
            "address_id"     => 532,
            "active"         => true,
            "created_at"     => "2006-02-14T22:04:37.000000Z",
            "updated_at"     => "2006-02-15T04:57:20.000000Z",
            "total_payments" => "221.55",
        ];

        $this->assertCount(10, $topTenPayingCustomers);
        $this->assertSame($expectedFirst, $topTenPayingCustomers->first()->toArray());
        $this->assertEqualsWithDelta(
            1912.96,
            $topTenPayingCustomers->sum('total_payments'),
            0.01,
            'Top 10 customers total spend should be 1912.96'
        );
    }

    public function testTotalSpend(): void
    {
        /** @var \Illuminate\Database\Eloquent\Collection<Customer> $topTenPayingCustomers
         * @noinspection PhpFullyQualifiedNameUsageInspection
         */
        $topTenPayingCustomers = Customer::select(['id', 'first_name', 'last_name'])
            ->addSelect([
                'total_payments' => Payment::selectRaw('SUM(amount)')
                    ->whereColumn('customer_id', 'customers.id'),
            ])
            ->orderByDesc('total_payments')
            ->get();

        $expectedFirst = [
            "id"             => 526,
            "first_name"     => "KARL",
            "last_name"      => "SEAL",
            "total_payments" => "221.55",
        ];

        $this->assertCount(599, $topTenPayingCustomers);
        $this->assertSame($expectedFirst, $topTenPayingCustomers->first()->toArray());
        $this->assertEqualsWithDelta(
            67416.51,
            $topTenPayingCustomers->sum('total_payments'),
            0.01,
            'total spend should be 67416.51'
        );
    }

    public function testCustomerPayments(): void
    {
        $sumByCustomer = Customer::withSum('payments', 'amount')
            ->withCount('payments')
            ->withAvg('payments', 'amount')
            ->orderByDesc('payments_sum_amount')
            ->limit(10)
            ->get();

        Log::info('sumByCustomer', [$sumByCustomer]);

        $expectedFirst = [
            'id'                  => 526,
            'store_id'            => 2,
            'first_name'          => 'KARL',
            'last_name'           => 'SEAL',
            'email'               => 'KARL.SEAL@sakilacustomer.org',
            'address_id'          => 532,
            'active'              => true,
            'created_at'          => '2006-02-14T22:04:37.000000Z',
            'updated_at'          => '2006-02-15T04:57:20.000000Z',
            'payments_sum_amount' => '221.55',
            'payments_count'      => 45,
            'payments_avg_amount' => '4.923333',
        ];

        $this->assertCount(10, $sumByCustomer);
        $this->assertSame($expectedFirst, $sumByCustomer->first()->toArray());
    }

    public function testCustomerFromAustraliaStore(): void
    {
        $australianCustomers = Customer::whereHas(
            'store.address.city.country',
            static fn($query) => $query->where('country', 'Australia')
        )
            ->get();

        Log::info('Australian customers', [$australianCustomers]);

        /*
            [{"Illuminate\\Database\\Eloquent\\Collection":[{"id":4,"store_id":2,"first_name":"BARBARA","last_name":"JONES","email":"BARBARA.JONES@sakilacustomer.org","address_id":8,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":6,"store_id":2,"first_name":"JENNIFER","last_name":"DAVIS","email":"JENNIFER.DAVIS@sakilacustomer.org","address_id":10,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":8,"store_id":2,"first_name":"SUSAN","last_name":"WILSON","email":"SUSAN.WILSON@sakilacustomer.org","address_id":12,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":9,"store_id":2,"first_name":"MARGARET","last_name":"MOORE","email":"MARGARET.MOORE@sakilacustomer.org","address_id":13,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":11,"store_id":2,"first_name":"LISA","last_name":"ANDERSON","email":"LISA.ANDERSON@sakilacustomer.org","address_id":15,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":13,"store_id":2,"first_name":"KAREN","last_name":"JACKSON","email":"KAREN.JACKSON@sakilacustomer.org","address_id":17,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":14,"store_id":2,"first_name":"BETTY","last_name":"WHITE","email":"BETTY.WHITE@sakilacustomer.org","address_id":18,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":16,"store_id":2,"first_name":"SANDRA","last_name":"MARTIN","email":"SANDRA.MARTIN@sakilacustomer.org","address_id":20,"active":false,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":18,"store_id":2,"first_name":"CAROL","last_name":"GARCIA","email":"CAROL.GARCIA@sakilacustomer.org","address_id":22,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":20,"store_id":2,"first_name":"SHARON","last_name":"ROBINSON","email":"SHARON.ROBINSON@sakilacustomer.org","address_id":24,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":23,"store_id":2,"first_name":"SARAH","last_name":"LEWIS","email":"SARAH.LEWIS@sakilacustomer.org","address_id":27,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":24,"store_id":2,"first_name":"KIMBERLY","last_name":"LEE","email":"KIMBERLY.LEE@sakilacustomer.org","address_id":28,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":26,"store_id":2,"first_name":"JESSICA","last_name":"HALL","email":"JESSICA.HALL@sakilacustomer.org","address_id":30,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":27,"store_id":2,"first_name":"SHIRLEY","last_name":"ALLEN","email":"SHIRLEY.ALLEN@sakilacustomer.org","address_id":31,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":29,"store_id":2,"first_name":"ANGELA","last_name":"HERNANDEZ","email":"ANGELA.HERNANDEZ@sakilacustomer.org","address_id":33,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":31,"store_id":2,"first_name":"BRENDA","last_name":"WRIGHT","email":"BRENDA.WRIGHT@sakilacustomer.org","address_id":35,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":33,"store_id":2,"first_name":"ANNA","last_name":"HILL","email":"ANNA.HILL@sakilacustomer.org","address_id":37,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":34,"store_id":2,"first_name":"REBECCA","last_name":"SCOTT","email":"REBECCA.SCOTT@sakilacustomer.org","address_id":38,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":35,"store_id":2,"first_name":"VIRGINIA","last_name":"GREEN","email":"VIRGINIA.GREEN@sakilacustomer.org","address_id":39,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":36,"store_id":2,"first_name":"KATHLEEN","last_name":"ADAMS","email":"KATHLEEN.ADAMS@sakilacustomer.org","address_id":40,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":40,"store_id":2,"first_name":"AMANDA","last_name":"CARTER","email":"AMANDA.CARTER@sakilacustomer.org","address_id":44,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":42,"store_id":2,"first_name":"CAROLYN","last_name":"PEREZ","email":"CAROLYN.PEREZ@sakilacustomer.org","address_id":46,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":43,"store_id":2,"first_name":"CHRISTINE","last_name":"ROBERTS","email":"CHRISTINE.ROBERTS@sakilacustomer.org","address_id":47,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":46,"store_id":2,"first_name":"CATHERINE","last_name":"CAMPBELL","email":"CATHERINE.CAMPBELL@sakilacustomer.org","address_id":50,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":49,"store_id":2,"first_name":"JOYCE","last_name":"EDWARDS","email":"JOYCE.EDWARDS@sakilacustomer.org","address_id":53,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":55,"store_id":2,"first_name":"DORIS","last_name":"REED","email":"DORIS.REED@sakilacustomer.org","address_id":59,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":57,"store_id":2,"first_name":"EVELYN","last_name":"MORGAN","email":"EVELYN.MORGAN@sakilacustomer.org","address_id":61,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":61,"store_id":2,"first_name":"KATHERINE","last_name":"RIVERA","email":"KATHERINE.RIVERA@sakilacustomer.org","address_id":65,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":64,"store_id":2,"first_name":"JUDITH","last_name":"COX","email":"JUDITH.COX@sakilacustomer.org","address_id":68,"active":false,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":65,"store_id":2,"first_name":"ROSE","last_name":"HOWARD","email":"ROSE.HOWARD@sakilacustomer.org","address_id":69,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":66,"store_id":2,"first_name":"JANICE","last_name":"WARD","email":"JANICE.WARD@sakilacustomer.org","address_id":70,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":69,"store_id":2,"first_name":"JUDY","last_name":"GRAY","email":"JUDY.GRAY@sakilacustomer.org","address_id":73,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":70,"store_id":2,"first_name":"CHRISTINA","last_name":"RAMIREZ","email":"CHRISTINA.RAMIREZ@sakilacustomer.org","address_id":74,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":72,"store_id":2,"first_name":"THERESA","last_name":"WATSON","email":"THERESA.WATSON@sakilacustomer.org","address_id":76,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":73,"store_id":2,"first_name":"BEVERLY","last_name":"BROOKS","email":"BEVERLY.BROOKS@sakilacustomer.org","address_id":77,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":75,"store_id":2,"first_name":"TAMMY","last_name":"SANDERS","email":"TAMMY.SANDERS@sakilacustomer.org","address_id":79,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":76,"store_id":2,"first_name":"IRENE","last_name":"PRICE","email":"IRENE.PRICE@sakilacustomer.org","address_id":80,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":77,"store_id":2,"first_name":"JANE","last_name":"BENNETT","email":"JANE.BENNETT@sakilacustomer.org","address_id":81,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":84,"store_id":2,"first_name":"SARA","last_name":"PERRY","email":"SARA.PERRY@sakilacustomer.org","address_id":88,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":85,"store_id":2,"first_name":"ANNE","last_name":"POWELL","email":"ANNE.POWELL@sakilacustomer.org","address_id":89,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":86,"store_id":2,"first_name":"JACQUELINE","last_name":"LONG","email":"JACQUELINE.LONG@sakilacustomer.org","address_id":90,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":88,"store_id":2,"first_name":"BONNIE","last_name":"HUGHES","email":"BONNIE.HUGHES@sakilacustomer.org","address_id":92,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":90,"store_id":2,"first_name":"RUBY","last_name":"WASHINGTON","email":"RUBY.WASHINGTON@sakilacustomer.org","address_id":94,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":91,"store_id":2,"first_name":"LOIS","last_name":"BUTLER","email":"LOIS.BUTLER@sakilacustomer.org","address_id":95,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":92,"store_id":2,"first_name":"TINA","last_name":"SIMMONS","email":"TINA.SIMMONS@sakilacustomer.org","address_id":96,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":95,"store_id":2,"first_name":"PAULA","last_name":"BRYANT","email":"PAULA.BRYANT@sakilacustomer.org","address_id":99,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":97,"store_id":2,"first_name":"ANNIE","last_name":"RUSSELL","email":"ANNIE.RUSSELL@sakilacustomer.org","address_id":101,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":99,"store_id":2,"first_name":"EMILY","last_name":"DIAZ","email":"EMILY.DIAZ@sakilacustomer.org","address_id":103,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":109,"store_id":2,"first_name":"EDNA","last_name":"WEST","email":"EDNA.WEST@sakilacustomer.org","address_id":113,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":110,"store_id":2,"first_name":"TIFFANY","last_name":"JORDAN","email":"TIFFANY.JORDAN@sakilacustomer.org","address_id":114,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":112,"store_id":2,"first_name":"ROSA","last_name":"REYNOLDS","email":"ROSA.REYNOLDS@sakilacustomer.org","address_id":116,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":113,"store_id":2,"first_name":"CINDY","last_name":"FISHER","email":"CINDY.FISHER@sakilacustomer.org","address_id":117,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":114,"store_id":2,"first_name":"GRACE","last_name":"ELLIS","email":"GRACE.ELLIS@sakilacustomer.org","address_id":118,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":120,"store_id":2,"first_name":"SYLVIA","last_name":"ORTIZ","email":"SYLVIA.ORTIZ@sakilacustomer.org","address_id":124,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":123,"store_id":2,"first_name":"SHANNON","last_name":"FREEMAN","email":"SHANNON.FREEMAN@sakilacustomer.org","address_id":127,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":127,"store_id":2,"first_name":"ELAINE","last_name":"STEVENS","email":"ELAINE.STEVENS@sakilacustomer.org","address_id":131,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":131,"store_id":2,"first_name":"MONICA","last_name":"HICKS","email":"MONICA.HICKS@sakilacustomer.org","address_id":135,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":132,"store_id":2,"first_name":"ESTHER","last_name":"CRAWFORD","email":"ESTHER.CRAWFORD@sakilacustomer.org","address_id":136,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":135,"store_id":2,"first_name":"JUANITA","last_name":"MASON","email":"JUANITA.MASON@sakilacustomer.org","address_id":139,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":136,"store_id":2,"first_name":"ANITA","last_name":"MORALES","email":"ANITA.MORALES@sakilacustomer.org","address_id":140,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":137,"store_id":2,"first_name":"RHONDA","last_name":"KENNEDY","email":"RHONDA.KENNEDY@sakilacustomer.org","address_id":141,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":147,"store_id":2,"first_name":"JOANNE","last_name":"ROBERTSON","email":"JOANNE.ROBERTSON@sakilacustomer.org","address_id":151,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":150,"store_id":2,"first_name":"DANIELLE","last_name":"DANIELS","email":"DANIELLE.DANIELS@sakilacustomer.org","address_id":154,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":151,"store_id":2,"first_name":"MEGAN","last_name":"PALMER","email":"MEGAN.PALMER@sakilacustomer.org","address_id":155,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":153,"store_id":2,"first_name":"SUZANNE","last_name":"NICHOLS","email":"SUZANNE.NICHOLS@sakilacustomer.org","address_id":157,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":154,"store_id":2,"first_name":"MICHELE","last_name":"GRANT","email":"MICHELE.GRANT@sakilacustomer.org","address_id":158,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":157,"store_id":2,"first_name":"DARLENE","last_name":"ROSE","email":"DARLENE.ROSE@sakilacustomer.org","address_id":161,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":160,"store_id":2,"first_name":"ERIN","last_name":"DUNN","email":"ERIN.DUNN@sakilacustomer.org","address_id":164,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":162,"store_id":2,"first_name":"LAUREN","last_name":"HUDSON","email":"LAUREN.HUDSON@sakilacustomer.org","address_id":166,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":164,"store_id":2,"first_name":"JOANN","last_name":"GARDNER","email":"JOANN.GARDNER@sakilacustomer.org","address_id":168,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":165,"store_id":2,"first_name":"LORRAINE","last_name":"STEPHENS","email":"LORRAINE.STEPHENS@sakilacustomer.org","address_id":169,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":167,"store_id":2,"first_name":"SALLY","last_name":"PIERCE","email":"SALLY.PIERCE@sakilacustomer.org","address_id":171,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":169,"store_id":2,"first_name":"ERICA","last_name":"MATTHEWS","email":"ERICA.MATTHEWS@sakilacustomer.org","address_id":173,"active":false,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":171,"store_id":2,"first_name":"DOLORES","last_name":"WAGNER","email":"DOLORES.WAGNER@sakilacustomer.org","address_id":175,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":174,"store_id":2,"first_name":"YVONNE","last_name":"WATKINS","email":"YVONNE.WATKINS@sakilacustomer.org","address_id":178,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":177,"store_id":2,"first_name":"SAMANTHA","last_name":"DUNCAN","email":"SAMANTHA.DUNCAN@sakilacustomer.org","address_id":181,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":178,"store_id":2,"first_name":"MARION","last_name":"SNYDER","email":"MARION.SNYDER@sakilacustomer.org","address_id":182,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":180,"store_id":2,"first_name":"STACY","last_name":"CUNNINGHAM","email":"STACY.CUNNINGHAM@sakilacustomer.org","address_id":184,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":181,"store_id":2,"first_name":"ANA","last_name":"BRADLEY","email":"ANA.BRADLEY@sakilacustomer.org","address_id":185,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":183,"store_id":2,"first_name":"IDA","last_name":"ANDREWS","email":"IDA.ANDREWS@sakilacustomer.org","address_id":187,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":186,"store_id":2,"first_name":"HOLLY","last_name":"FOX","email":"HOLLY.FOX@sakilacustomer.org","address_id":190,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":187,"store_id":2,"first_name":"BRITTANY","last_name":"RILEY","email":"BRITTANY.RILEY@sakilacustomer.org","address_id":191,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":190,"store_id":2,"first_name":"YOLANDA","last_name":"WEAVER","email":"YOLANDA.WEAVER@sakilacustomer.org","address_id":194,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":193,"store_id":2,"first_name":"KATIE","last_name":"ELLIOTT","email":"KATIE.ELLIOTT@sakilacustomer.org","address_id":197,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":194,"store_id":2,"first_name":"KRISTEN","last_name":"CHAVEZ","email":"KRISTEN.CHAVEZ@sakilacustomer.org","address_id":198,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":197,"store_id":2,"first_name":"SUE","last_name":"PETERS","email":"SUE.PETERS@sakilacustomer.org","address_id":201,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":198,"store_id":2,"first_name":"ELSIE","last_name":"KELLEY","email":"ELSIE.KELLEY@sakilacustomer.org","address_id":202,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":199,"store_id":2,"first_name":"BETH","last_name":"FRANKLIN","email":"BETH.FRANKLIN@sakilacustomer.org","address_id":203,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":200,"store_id":2,"first_name":"JEANNE","last_name":"LAWSON","email":"JEANNE.LAWSON@sakilacustomer.org","address_id":204,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":202,"store_id":2,"first_name":"CARLA","last_name":"GUTIERREZ","email":"CARLA.GUTIERREZ@sakilacustomer.org","address_id":206,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":205,"store_id":2,"first_name":"EILEEN","last_name":"CARR","email":"EILEEN.CARR@sakilacustomer.org","address_id":209,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":209,"store_id":2,"first_name":"TONYA","last_name":"CHAPMAN","email":"TONYA.CHAPMAN@sakilacustomer.org","address_id":213,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":210,"store_id":2,"first_name":"ELLA","last_name":"OLIVER","email":"ELLA.OLIVER@sakilacustomer.org","address_id":214,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":212,"store_id":2,"first_name":"WILMA","last_name":"RICHARDS","email":"WILMA.RICHARDS@sakilacustomer.org","address_id":216,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":215,"store_id":2,"first_name":"JESSIE","last_name":"BANKS","email":"JESSIE.BANKS@sakilacustomer.org","address_id":219,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":217,"store_id":2,"first_name":"AGNES","last_name":"BISHOP","email":"AGNES.BISHOP@sakilacustomer.org","address_id":221,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":219,"store_id":2,"first_name":"WILLIE","last_name":"HOWELL","email":"WILLIE.HOWELL@sakilacustomer.org","address_id":223,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":220,"store_id":2,"first_name":"CHARLENE","last_name":"ALVAREZ","email":"CHARLENE.ALVAREZ@sakilacustomer.org","address_id":224,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":222,"store_id":2,"first_name":"DELORES","last_name":"HANSEN","email":"DELORES.HANSEN@sakilacustomer.org","address_id":226,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":224,"store_id":2,"first_name":"PEARL","last_name":"GARZA","email":"PEARL.GARZA@sakilacustomer.org","address_id":228,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":226,"store_id":2,"first_name":"MAUREEN","last_name":"LITTLE","email":"MAUREEN.LITTLE@sakilacustomer.org","address_id":230,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":228,"store_id":2,"first_name":"ALLISON","last_name":"STANLEY","email":"ALLISON.STANLEY@sakilacustomer.org","address_id":232,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":230,"store_id":2,"first_name":"JOY","last_name":"GEORGE","email":"JOY.GEORGE@sakilacustomer.org","address_id":234,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":232,"store_id":2,"first_name":"CONSTANCE","last_name":"REID","email":"CONSTANCE.REID@sakilacustomer.org","address_id":236,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":233,"store_id":2,"first_name":"LILLIE","last_name":"KIM","email":"LILLIE.KIM@sakilacustomer.org","address_id":237,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":239,"store_id":2,"first_name":"MINNIE","last_name":"ROMERO","email":"MINNIE.ROMERO@sakilacustomer.org","address_id":243,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":241,"store_id":2,"first_name":"HEIDI","last_name":"LARSON","email":"HEIDI.LARSON@sakilacustomer.org","address_id":245,"active":false,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":244,"store_id":2,"first_name":"VIOLA","last_name":"HANSON","email":"VIOLA.HANSON@sakilacustomer.org","address_id":248,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":249,"store_id":2,"first_name":"DORA","last_name":"MEDINA","email":"DORA.MEDINA@sakilacustomer.org","address_id":253,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":250,"store_id":2,"first_name":"JO","last_name":"FOWLER","email":"JO.FOWLER@sakilacustomer.org","address_id":254,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":251,"store_id":2,"first_name":"VICKIE","last_name":"BREWER","email":"VICKIE.BREWER@sakilacustomer.org","address_id":255,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":252,"store_id":2,"first_name":"MATTIE","last_name":"HOFFMAN","email":"MATTIE.HOFFMAN@sakilacustomer.org","address_id":256,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":254,"store_id":2,"first_name":"MAXINE","last_name":"SILVA","email":"MAXINE.SILVA@sakilacustomer.org","address_id":259,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":255,"store_id":2,"first_name":"IRMA","last_name":"PEARSON","email":"IRMA.PEARSON@sakilacustomer.org","address_id":260,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":256,"store_id":2,"first_name":"MABEL","last_name":"HOLLAND","email":"MABEL.HOLLAND@sakilacustomer.org","address_id":261,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":257,"store_id":2,"first_name":"MARSHA","last_name":"DOUGLAS","email":"MARSHA.DOUGLAS@sakilacustomer.org","address_id":262,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":259,"store_id":2,"first_name":"LENA","last_name":"JENSEN","email":"LENA.JENSEN@sakilacustomer.org","address_id":264,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":262,"store_id":2,"first_name":"PATSY","last_name":"DAVIDSON","email":"PATSY.DAVIDSON@sakilacustomer.org","address_id":267,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":265,"store_id":2,"first_name":"JENNIE","last_name":"TERRY","email":"JENNIE.TERRY@sakilacustomer.org","address_id":270,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":266,"store_id":2,"first_name":"NORA","last_name":"HERRERA","email":"NORA.HERRERA@sakilacustomer.org","address_id":271,"active":true,"created_at":"2006-02-14T22:04:36.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":273,"store_id":2,"first_name":"PRISCILLA","last_name":"LOWE","email":"PRISCILLA.LOWE@sakilacustomer.org","address_id":278,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":275,"store_id":2,"first_name":"CAROLE","last_name":"BARNETT","email":"CAROLE.BARNETT@sakilacustomer.org","address_id":280,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":277,"store_id":2,"first_name":"OLGA","last_name":"JIMENEZ","email":"OLGA.JIMENEZ@sakilacustomer.org","address_id":282,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":278,"store_id":2,"first_name":"BILLIE","last_name":"HORTON","email":"BILLIE.HORTON@sakilacustomer.org","address_id":283,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":279,"store_id":2,"first_name":"DIANNE","last_name":"SHELTON","email":"DIANNE.SHELTON@sakilacustomer.org","address_id":284,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":280,"store_id":2,"first_name":"TRACEY","last_name":"BARRETT","email":"TRACEY.BARRETT@sakilacustomer.org","address_id":285,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":281,"store_id":2,"first_name":"LEONA","last_name":"OBRIEN","email":"LEONA.OBRIEN@sakilacustomer.org","address_id":286,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":282,"store_id":2,"first_name":"JENNY","last_name":"CASTRO","email":"JENNY.CASTRO@sakilacustomer.org","address_id":287,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":287,"store_id":2,"first_name":"BECKY","last_name":"MILES","email":"BECKY.MILES@sakilacustomer.org","address_id":292,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":292,"store_id":2,"first_name":"MISTY","last_name":"LAMBERT","email":"MISTY.LAMBERT@sakilacustomer.org","address_id":297,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":293,"store_id":2,"first_name":"MAE","last_name":"FLETCHER","email":"MAE.FLETCHER@sakilacustomer.org","address_id":298,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":294,"store_id":2,"first_name":"SHELLY","last_name":"WATTS","email":"SHELLY.WATTS@sakilacustomer.org","address_id":299,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":296,"store_id":2,"first_name":"RAMONA","last_name":"HALE","email":"RAMONA.HALE@sakilacustomer.org","address_id":301,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":299,"store_id":2,"first_name":"JAMES","last_name":"GANNON","email":"JAMES.GANNON@sakilacustomer.org","address_id":304,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":301,"store_id":2,"first_name":"ROBERT","last_name":"BAUGHMAN","email":"ROBERT.BAUGHMAN@sakilacustomer.org","address_id":306,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":303,"store_id":2,"first_name":"WILLIAM","last_name":"SATTERFIELD","email":"WILLIAM.SATTERFIELD@sakilacustomer.org","address_id":308,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":304,"store_id":2,"first_name":"DAVID","last_name":"ROYAL","email":"DAVID.ROYAL@sakilacustomer.org","address_id":309,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":307,"store_id":2,"first_name":"JOSEPH","last_name":"JOY","email":"JOSEPH.JOY@sakilacustomer.org","address_id":312,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":310,"store_id":2,"first_name":"DANIEL","last_name":"CABRAL","email":"DANIEL.CABRAL@sakilacustomer.org","address_id":315,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":311,"store_id":2,"first_name":"PAUL","last_name":"TROUT","email":"PAUL.TROUT@sakilacustomer.org","address_id":316,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":312,"store_id":2,"first_name":"MARK","last_name":"RINEHART","email":"MARK.RINEHART@sakilacustomer.org","address_id":317,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":313,"store_id":2,"first_name":"DONALD","last_name":"MAHON","email":"DONALD.MAHON@sakilacustomer.org","address_id":318,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":315,"store_id":2,"first_name":"KENNETH","last_name":"GOODEN","email":"KENNETH.GOODEN@sakilacustomer.org","address_id":320,"active":false,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":317,"store_id":2,"first_name":"EDWARD","last_name":"BAUGH","email":"EDWARD.BAUGH@sakilacustomer.org","address_id":322,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":319,"store_id":2,"first_name":"RONALD","last_name":"WEINER","email":"RONALD.WEINER@sakilacustomer.org","address_id":324,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":320,"store_id":2,"first_name":"ANTHONY","last_name":"SCHWAB","email":"ANTHONY.SCHWAB@sakilacustomer.org","address_id":325,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":323,"store_id":2,"first_name":"MATTHEW","last_name":"MAHAN","email":"MATTHEW.MAHAN@sakilacustomer.org","address_id":328,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":324,"store_id":2,"first_name":"GARY","last_name":"COY","email":"GARY.COY@sakilacustomer.org","address_id":329,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":327,"store_id":2,"first_name":"LARRY","last_name":"THRASHER","email":"LARRY.THRASHER@sakilacustomer.org","address_id":332,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":328,"store_id":2,"first_name":"JEFFREY","last_name":"SPEAR","email":"JEFFREY.SPEAR@sakilacustomer.org","address_id":333,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":329,"store_id":2,"first_name":"FRANK","last_name":"WAGGONER","email":"FRANK.WAGGONER@sakilacustomer.org","address_id":334,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":333,"store_id":2,"first_name":"ANDREW","last_name":"PURDY","email":"ANDREW.PURDY@sakilacustomer.org","address_id":338,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":334,"store_id":2,"first_name":"RAYMOND","last_name":"MCWHORTER","email":"RAYMOND.MCWHORTER@sakilacustomer.org","address_id":339,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":339,"store_id":2,"first_name":"WALTER","last_name":"PERRYMAN","email":"WALTER.PERRYMAN@sakilacustomer.org","address_id":344,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":347,"store_id":2,"first_name":"RYAN","last_name":"SALISBURY","email":"RYAN.SALISBURY@sakilacustomer.org","address_id":352,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":348,"store_id":2,"first_name":"ROGER","last_name":"QUINTANILLA","email":"ROGER.QUINTANILLA@sakilacustomer.org","address_id":353,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":349,"store_id":2,"first_name":"JOE","last_name":"GILLILAND","email":"JOE.GILLILAND@sakilacustomer.org","address_id":354,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":354,"store_id":2,"first_name":"JUSTIN","last_name":"NGO","email":"JUSTIN.NGO@sakilacustomer.org","address_id":359,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":355,"store_id":2,"first_name":"TERRY","last_name":"GRISSOM","email":"TERRY.GRISSOM@sakilacustomer.org","address_id":360,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":356,"store_id":2,"first_name":"GERALD","last_name":"FULTZ","email":"GERALD.FULTZ@sakilacustomer.org","address_id":361,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":358,"store_id":2,"first_name":"SAMUEL","last_name":"MARLOW","email":"SAMUEL.MARLOW@sakilacustomer.org","address_id":363,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":359,"store_id":2,"first_name":"WILLIE","last_name":"MARKHAM","email":"WILLIE.MARKHAM@sakilacustomer.org","address_id":364,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":360,"store_id":2,"first_name":"RALPH","last_name":"MADRIGAL","email":"RALPH.MADRIGAL@sakilacustomer.org","address_id":365,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":361,"store_id":2,"first_name":"LAWRENCE","last_name":"LAWTON","email":"LAWRENCE.LAWTON@sakilacustomer.org","address_id":366,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":363,"store_id":2,"first_name":"ROY","last_name":"WHITING","email":"ROY.WHITING@sakilacustomer.org","address_id":368,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":365,"store_id":2,"first_name":"BRUCE","last_name":"SCHWARZ","email":"BRUCE.SCHWARZ@sakilacustomer.org","address_id":370,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":369,"store_id":2,"first_name":"FRED","last_name":"WHEAT","email":"FRED.WHEAT@sakilacustomer.org","address_id":374,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":370,"store_id":2,"first_name":"WAYNE","last_name":"TRUONG","email":"WAYNE.TRUONG@sakilacustomer.org","address_id":375,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":372,"store_id":2,"first_name":"STEVE","last_name":"MACKENZIE","email":"STEVE.MACKENZIE@sakilacustomer.org","address_id":377,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":374,"store_id":2,"first_name":"JEREMY","last_name":"HURTADO","email":"JEREMY.HURTADO@sakilacustomer.org","address_id":379,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":375,"store_id":2,"first_name":"AARON","last_name":"SELBY","email":"AARON.SELBY@sakilacustomer.org","address_id":380,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":381,"store_id":2,"first_name":"BOBBY","last_name":"BOUDREAU","email":"BOBBY.BOUDREAU@sakilacustomer.org","address_id":386,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":382,"store_id":2,"first_name":"VICTOR","last_name":"BARKLEY","email":"VICTOR.BARKLEY@sakilacustomer.org","address_id":387,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":384,"store_id":2,"first_name":"ERNEST","last_name":"STEPP","email":"ERNEST.STEPP@sakilacustomer.org","address_id":389,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":387,"store_id":2,"first_name":"JESSE","last_name":"SCHILLING","email":"JESSE.SCHILLING@sakilacustomer.org","address_id":392,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":388,"store_id":2,"first_name":"CRAIG","last_name":"MORRELL","email":"CRAIG.MORRELL@sakilacustomer.org","address_id":393,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":392,"store_id":2,"first_name":"SEAN","last_name":"DOUGLASS","email":"SEAN.DOUGLASS@sakilacustomer.org","address_id":397,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":394,"store_id":2,"first_name":"CHRIS","last_name":"BROTHERS","email":"CHRIS.BROTHERS@sakilacustomer.org","address_id":399,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":395,"store_id":2,"first_name":"JOHNNY","last_name":"TURPIN","email":"JOHNNY.TURPIN@sakilacustomer.org","address_id":400,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":400,"store_id":2,"first_name":"BRYAN","last_name":"HARDISON","email":"BRYAN.HARDISON@sakilacustomer.org","address_id":405,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":401,"store_id":2,"first_name":"TONY","last_name":"CARRANZA","email":"TONY.CARRANZA@sakilacustomer.org","address_id":406,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":404,"store_id":2,"first_name":"STANLEY","last_name":"SCROGGINS","email":"STANLEY.SCROGGINS@sakilacustomer.org","address_id":409,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":409,"store_id":2,"first_name":"RODNEY","last_name":"MOELLER","email":"RODNEY.MOELLER@sakilacustomer.org","address_id":414,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":410,"store_id":2,"first_name":"CURTIS","last_name":"IRBY","email":"CURTIS.IRBY@sakilacustomer.org","address_id":415,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":412,"store_id":2,"first_name":"ALLEN","last_name":"BUTTERFIELD","email":"ALLEN.BUTTERFIELD@sakilacustomer.org","address_id":417,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":413,"store_id":2,"first_name":"MARVIN","last_name":"YEE","email":"MARVIN.YEE@sakilacustomer.org","address_id":418,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":416,"store_id":2,"first_name":"JEFFERY","last_name":"PINSON","email":"JEFFERY.PINSON@sakilacustomer.org","address_id":421,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":418,"store_id":2,"first_name":"JEFF","last_name":"EAST","email":"JEFF.EAST@sakilacustomer.org","address_id":423,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":423,"store_id":2,"first_name":"ALFRED","last_name":"CASILLAS","email":"ALFRED.CASILLAS@sakilacustomer.org","address_id":428,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":424,"store_id":2,"first_name":"KYLE","last_name":"SPURLOCK","email":"KYLE.SPURLOCK@sakilacustomer.org","address_id":429,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":425,"store_id":2,"first_name":"FRANCIS","last_name":"SIKES","email":"FRANCIS.SIKES@sakilacustomer.org","address_id":430,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":427,"store_id":2,"first_name":"JESUS","last_name":"MCCARTNEY","email":"JESUS.MCCARTNEY@sakilacustomer.org","address_id":432,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":428,"store_id":2,"first_name":"HERBERT","last_name":"KRUGER","email":"HERBERT.KRUGER@sakilacustomer.org","address_id":433,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":429,"store_id":2,"first_name":"FREDERICK","last_name":"ISBELL","email":"FREDERICK.ISBELL@sakilacustomer.org","address_id":434,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":431,"store_id":2,"first_name":"JOEL","last_name":"FRANCISCO","email":"JOEL.FRANCISCO@sakilacustomer.org","address_id":436,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":435,"store_id":2,"first_name":"RICKY","last_name":"SHELBY","email":"RICKY.SHELBY@sakilacustomer.org","address_id":440,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":437,"store_id":2,"first_name":"RANDALL","last_name":"NEUMANN","email":"RANDALL.NEUMANN@sakilacustomer.org","address_id":442,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":439,"store_id":2,"first_name":"ALEXANDER","last_name":"FENNELL","email":"ALEXANDER.FENNELL@sakilacustomer.org","address_id":444,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":443,"store_id":2,"first_name":"FRANCISCO","last_name":"SKIDMORE","email":"FRANCISCO.SKIDMORE@sakilacustomer.org","address_id":448,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":444,"store_id":2,"first_name":"MARCUS","last_name":"HIDALGO","email":"MARCUS.HIDALGO@sakilacustomer.org","address_id":449,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":446,"store_id":2,"first_name":"THEODORE","last_name":"CULP","email":"THEODORE.CULP@sakilacustomer.org","address_id":451,"active":false,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":449,"store_id":2,"first_name":"OSCAR","last_name":"AQUINO","email":"OSCAR.AQUINO@sakilacustomer.org","address_id":454,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":454,"store_id":2,"first_name":"ALEX","last_name":"GRESHAM","email":"ALEX.GRESHAM@sakilacustomer.org","address_id":459,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":455,"store_id":2,"first_name":"JON","last_name":"WILES","email":"JON.WILES@sakilacustomer.org","address_id":460,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":456,"store_id":2,"first_name":"RONNIE","last_name":"RICKETTS","email":"RONNIE.RICKETTS@sakilacustomer.org","address_id":461,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":457,"store_id":2,"first_name":"BILL","last_name":"GAVIN","email":"BILL.GAVIN@sakilacustomer.org","address_id":462,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":462,"store_id":2,"first_name":"WARREN","last_name":"SHERROD","email":"WARREN.SHERROD@sakilacustomer.org","address_id":467,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":463,"store_id":2,"first_name":"DARRELL","last_name":"POWER","email":"DARRELL.POWER@sakilacustomer.org","address_id":468,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":467,"store_id":2,"first_name":"ALVIN","last_name":"DELOACH","email":"ALVIN.DELOACH@sakilacustomer.org","address_id":472,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":469,"store_id":2,"first_name":"WESLEY","last_name":"BULL","email":"WESLEY.BULL@sakilacustomer.org","address_id":474,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":473,"store_id":2,"first_name":"JORGE","last_name":"OLIVARES","email":"JORGE.OLIVARES@sakilacustomer.org","address_id":478,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":474,"store_id":2,"first_name":"DUSTIN","last_name":"GILLETTE","email":"DUSTIN.GILLETTE@sakilacustomer.org","address_id":479,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":475,"store_id":2,"first_name":"PEDRO","last_name":"CHESTNUT","email":"PEDRO.CHESTNUT@sakilacustomer.org","address_id":480,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":483,"store_id":2,"first_name":"VERNON","last_name":"CHAPA","email":"VERNON.CHAPA@sakilacustomer.org","address_id":488,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":487,"store_id":2,"first_name":"HECTOR","last_name":"POINDEXTER","email":"HECTOR.POINDEXTER@sakilacustomer.org","address_id":492,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":488,"store_id":2,"first_name":"SHANE","last_name":"MILLARD","email":"SHANE.MILLARD@sakilacustomer.org","address_id":493,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":491,"store_id":2,"first_name":"RICK","last_name":"MATTOX","email":"RICK.MATTOX@sakilacustomer.org","address_id":496,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":492,"store_id":2,"first_name":"LESTER","last_name":"KRAUS","email":"LESTER.KRAUS@sakilacustomer.org","address_id":497,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":494,"store_id":2,"first_name":"RAMON","last_name":"CHOATE","email":"RAMON.CHOATE@sakilacustomer.org","address_id":499,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":495,"store_id":2,"first_name":"CHARLIE","last_name":"BESS","email":"CHARLIE.BESS@sakilacustomer.org","address_id":500,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":496,"store_id":2,"first_name":"TYLER","last_name":"WREN","email":"TYLER.WREN@sakilacustomer.org","address_id":501,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":497,"store_id":2,"first_name":"GILBERT","last_name":"SLEDGE","email":"GILBERT.SLEDGE@sakilacustomer.org","address_id":502,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":499,"store_id":2,"first_name":"MARC","last_name":"OUTLAW","email":"MARC.OUTLAW@sakilacustomer.org","address_id":504,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":506,"store_id":2,"first_name":"LESLIE","last_name":"SEWARD","email":"LESLIE.SEWARD@sakilacustomer.org","address_id":511,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":507,"store_id":2,"first_name":"EDGAR","last_name":"RHOADS","email":"EDGAR.RHOADS@sakilacustomer.org","address_id":512,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":508,"store_id":2,"first_name":"MILTON","last_name":"HOWLAND","email":"MILTON.HOWLAND@sakilacustomer.org","address_id":513,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":510,"store_id":2,"first_name":"BEN","last_name":"EASTER","email":"BEN.EASTER@sakilacustomer.org","address_id":515,"active":false,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":513,"store_id":2,"first_name":"DUANE","last_name":"TUBBS","email":"DUANE.TUBBS@sakilacustomer.org","address_id":519,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":514,"store_id":2,"first_name":"FRANKLIN","last_name":"TROUTMAN","email":"FRANKLIN.TROUTMAN@sakilacustomer.org","address_id":520,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":516,"store_id":2,"first_name":"ELMER","last_name":"NOE","email":"ELMER.NOE@sakilacustomer.org","address_id":522,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":517,"store_id":2,"first_name":"BRAD","last_name":"MCCURDY","email":"BRAD.MCCURDY@sakilacustomer.org","address_id":523,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":519,"store_id":2,"first_name":"RON","last_name":"DELUCA","email":"RON.DELUCA@sakilacustomer.org","address_id":525,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":520,"store_id":2,"first_name":"MITCHELL","last_name":"WESTMORELAND","email":"MITCHELL.WESTMORELAND@sakilacustomer.org","address_id":526,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":521,"store_id":2,"first_name":"ROLAND","last_name":"SOUTH","email":"ROLAND.SOUTH@sakilacustomer.org","address_id":527,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":522,"store_id":2,"first_name":"ARNOLD","last_name":"HAVENS","email":"ARNOLD.HAVENS@sakilacustomer.org","address_id":528,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":525,"store_id":2,"first_name":"ADRIAN","last_name":"CLARY","email":"ADRIAN.CLARY@sakilacustomer.org","address_id":531,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":526,"store_id":2,"first_name":"KARL","last_name":"SEAL","email":"KARL.SEAL@sakilacustomer.org","address_id":532,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":529,"store_id":2,"first_name":"ERIK","last_name":"GUILLEN","email":"ERIK.GUILLEN@sakilacustomer.org","address_id":535,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":530,"store_id":2,"first_name":"DARRYL","last_name":"ASHCRAFT","email":"DARRYL.ASHCRAFT@sakilacustomer.org","address_id":536,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":531,"store_id":2,"first_name":"JAMIE","last_name":"WAUGH","email":"JAMIE.WAUGH@sakilacustomer.org","address_id":537,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":532,"store_id":2,"first_name":"NEIL","last_name":"RENNER","email":"NEIL.RENNER@sakilacustomer.org","address_id":538,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":536,"store_id":2,"first_name":"FERNANDO","last_name":"CHURCHILL","email":"FERNANDO.CHURCHILL@sakilacustomer.org","address_id":542,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":537,"store_id":2,"first_name":"CLINTON","last_name":"BUFORD","email":"CLINTON.BUFORD@sakilacustomer.org","address_id":543,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":538,"store_id":2,"first_name":"TED","last_name":"BREAUX","email":"TED.BREAUX@sakilacustomer.org","address_id":544,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":541,"store_id":2,"first_name":"DARREN","last_name":"WINDHAM","email":"DARREN.WINDHAM@sakilacustomer.org","address_id":547,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":542,"store_id":2,"first_name":"LONNIE","last_name":"TIRADO","email":"LONNIE.TIRADO@sakilacustomer.org","address_id":548,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":544,"store_id":2,"first_name":"CODY","last_name":"NOLEN","email":"CODY.NOLEN@sakilacustomer.org","address_id":550,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":545,"store_id":2,"first_name":"JULIO","last_name":"NOLAND","email":"JULIO.NOLAND@sakilacustomer.org","address_id":551,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":550,"store_id":2,"first_name":"GUY","last_name":"BROWNLEE","email":"GUY.BROWNLEE@sakilacustomer.org","address_id":556,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":551,"store_id":2,"first_name":"CLAYTON","last_name":"BARBEE","email":"CLAYTON.BARBEE@sakilacustomer.org","address_id":557,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":552,"store_id":2,"first_name":"HUGH","last_name":"WALDROP","email":"HUGH.WALDROP@sakilacustomer.org","address_id":558,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":556,"store_id":2,"first_name":"ARMANDO","last_name":"GRUBER","email":"ARMANDO.GRUBER@sakilacustomer.org","address_id":562,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":559,"store_id":2,"first_name":"EVERETT","last_name":"BANDA","email":"EVERETT.BANDA@sakilacustomer.org","address_id":565,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":561,"store_id":2,"first_name":"IAN","last_name":"STILL","email":"IAN.STILL@sakilacustomer.org","address_id":567,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":563,"store_id":2,"first_name":"KEN","last_name":"PREWITT","email":"KEN.PREWITT@sakilacustomer.org","address_id":569,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":564,"store_id":2,"first_name":"BOB","last_name":"PFEIFFER","email":"BOB.PFEIFFER@sakilacustomer.org","address_id":570,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":565,"store_id":2,"first_name":"JAIME","last_name":"NETTLES","email":"JAIME.NETTLES@sakilacustomer.org","address_id":571,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":567,"store_id":2,"first_name":"ALFREDO","last_name":"MCADAMS","email":"ALFREDO.MCADAMS@sakilacustomer.org","address_id":573,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":568,"store_id":2,"first_name":"ALBERTO","last_name":"HENNING","email":"ALBERTO.HENNING@sakilacustomer.org","address_id":574,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":569,"store_id":2,"first_name":"DAVE","last_name":"GARDINER","email":"DAVE.GARDINER@sakilacustomer.org","address_id":575,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":570,"store_id":2,"first_name":"IVAN","last_name":"CROMWELL","email":"IVAN.CROMWELL@sakilacustomer.org","address_id":576,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":571,"store_id":2,"first_name":"JOHNNIE","last_name":"CHISHOLM","email":"JOHNNIE.CHISHOLM@sakilacustomer.org","address_id":577,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":574,"store_id":2,"first_name":"JULIAN","last_name":"VEST","email":"JULIAN.VEST@sakilacustomer.org","address_id":580,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":575,"store_id":2,"first_name":"ISAAC","last_name":"OGLESBY","email":"ISAAC.OGLESBY@sakilacustomer.org","address_id":581,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":576,"store_id":2,"first_name":"MORRIS","last_name":"MCCARTER","email":"MORRIS.MCCARTER@sakilacustomer.org","address_id":582,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":577,"store_id":2,"first_name":"CLIFTON","last_name":"MALCOLM","email":"CLIFTON.MALCOLM@sakilacustomer.org","address_id":583,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":578,"store_id":2,"first_name":"WILLARD","last_name":"LUMPKIN","email":"WILLARD.LUMPKIN@sakilacustomer.org","address_id":584,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":579,"store_id":2,"first_name":"DARYL","last_name":"LARUE","email":"DARYL.LARUE@sakilacustomer.org","address_id":585,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":582,"store_id":2,"first_name":"ANDY","last_name":"VANHORN","email":"ANDY.VANHORN@sakilacustomer.org","address_id":588,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":584,"store_id":2,"first_name":"SALVADOR","last_name":"TEEL","email":"SALVADOR.TEEL@sakilacustomer.org","address_id":590,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":590,"store_id":2,"first_name":"SETH","last_name":"HANNON","email":"SETH.HANNON@sakilacustomer.org","address_id":596,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":593,"store_id":2,"first_name":"RENE","last_name":"MCALISTER","email":"RENE.MCALISTER@sakilacustomer.org","address_id":599,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"},{"id":599,"store_id":2,"first_name":"AUSTIN","last_name":"CINTRON","email":"AUSTIN.CINTRON@sakilacustomer.org","address_id":605,"active":true,"created_at":"2006-02-14T22:04:37.000000Z","updated_at":"2006-02-15T04:57:20.000000Z"}]}]
        */

        $this->assertCount(273, $australianCustomers);
    }

    public function testCustomerWhoWatchedActionFilms(): void
    {
        $customersWhoWatchedActionFilms = Customer::whereHas(
            'store.films.categories',
            static fn($query) => $query->where('name', 'Action')
        )
            ->get();

        $this->assertCount(599, $customersWhoWatchedActionFilms);
        $this->assertSame('MARY SMITH', $customersWhoWatchedActionFilms->first()->fullName);
    }

    public function testCustomerWhoRentedZorroArkUsingWhereHas(): void
    {
        $customersWhoWatchedZorroArk = Customer::whereHas(
            'rentals.film',
            static fn($query) => $query->whereTitle('ZORRO ARK')
        )->where('store_id', 1)
            ->get();

        $this->assertCount(16, $customersWhoWatchedZorroArk);
        $this->assertSame('NANCY THOMAS', $customersWhoWatchedZorroArk->first()->fullName);
    }

    public function testCustomerWhoRentedZorroArkUsingJoinsAndWhere(): void
    {
        $customersWhoWatchedZorroArk = Customer::select(['customers.*', 'rentals.rental_date'])
            ->join('rentals', 'customers.id', '=', 'rentals.customer_id')
            ->join('inventories', 'rentals.inventory_id', '=', 'inventories.id')
            ->join('films', 'inventories.film_id', '=', 'films.id')
            ->where('films.title', '=', 'ZORRO ARK')
            ->where('inventories.store_id', '=', 1)
            ->orderBy('rentals.rental_date')
            ->get();

        $this->assertCount(16, $customersWhoWatchedZorroArk);
        $this->assertSame('NANCY THOMAS', $customersWhoWatchedZorroArk->first()->fullName);
    }

    public function testCustomersWithOutstandingRentals(): void
    {
        $customersWithOutstandingRentals = Customer::select('id')->whereRelation('rentals', 'return_date', '=', null)->get();

        info('CustomersWithOutstandingRentals', [$customersWithOutstandingRentals]);

        $this->assertSame(159, $customersWithOutstandingRentals->count());
    }
}
